# Feature Definition Template
# EPF v2.0.0 - Schema-compliant YAML template
# 
# INSTRUCTIONS:
# 1. Copy this template to your instance: _instances/{product}/FIRE/feature_definitions/
# 2. Rename to: fd-{number}-{slug}.yaml (e.g., fd-007-user-authentication.yaml)
# 3. Fill in all placeholder fields (marked with {})
# 4. Review examples in /features/ directory for quality patterns
# 5. Validate: ./scripts/validate-feature-quality.sh {your-file}.yaml
# 6. Fix any errors, re-validate until 0 errors
# 7. Commit only after passing validation
#
# For detailed guidance:
# - Creation wizard: wizards/feature_definition.wizard.md
# - AI agent guidance: wizards/product_architect.agent_prompt.md
# - Validation schema: schemas/feature_definition_schema.json
# - Example features: features/ directory (21 validated examples)

# Basic Metadata
id: fd-{number}  # Example: fd-007
name: "{Feature Name}"  # Example: "User Authentication & Authorization"
slug: "{feature-slug}"  # Example: "user-authentication-authorization"
status: draft  # Options: draft | ready | in-progress | delivered

# Strategic Context
strategic_context:
  # Problem Statement: 3-4 sentences describing the problem this feature solves
  # - Who experiences this problem?
  # - What pain does it cause?
  # - What is the business impact if not solved?
  problem_statement: |
    {Describe the problem in 3-4 sentences. Focus on user pain, current friction, 
    business impact, and why this matters strategically. Be specific about who 
    experiences this problem and what outcomes they cannot achieve without this feature.}

  # Market Context: 3-4 sentences about market landscape
  # - What solutions exist currently?
  # - What are their limitations?
  # - What opportunity does this create?
  market_context: |
    {Describe the market context in 3-4 sentences. What do competitors offer? 
    What gaps exist? What trends are relevant? What makes our approach differentiated?}

  # Value Model Contribution: Which L2/L3 components receive value from this feature?
  # N:M mapping - feature can contribute to multiple components
  contributes_to:
    - {ValueModel.Layer.Component}  # Example: Product.Decide.Analysis
    - {ValueModel.Layer.Component}  # Example: Product.Operate.Knowledge

  # Roadmap Tracks: Which track(s) does this feature belong to?
  tracks:
    - {track-name}  # Options: product | strategy | org_ops | commercial

  # Success Metrics: How will we measure this feature's impact?
  success_metrics:
    - metric: "{Metric name}"  # Example: "Time to complete user onboarding"
      target: "{Target outcome with timeline}"  # Example: "Reduce from 15 minutes to <5 minutes within 2 months"
      measurement: "{How to measure}"  # Example: "Average onboarding duration from analytics tracking"

# Definition
definition:
  # Job to Be Done: User need in format "When [situation], I want to [motivation], so I can [outcome]"
  job_to_be_done: |
    When {situation}, {user type} want to {motivation}, 
    so they can {expected outcome and benefits}.

  # Solution Approach: High-level description of HOW this feature works from user perspective
  solution_approach: |
    {Describe the solution in 2-3 sentences. Focus on WHAT happens and HOW users
    experience it, not technical implementation details. What workflow changes?
    What becomes possible that wasn't before?}

  # Capabilities: Key capabilities this feature provides
  capabilities:
    - id: cap-001
      name: "{Capability Name}"  # Example: "Multi-Factor Authentication"
      description: |
        {Describe what this capability does. Be specific about functionality,
        user experience, and value delivered. 2-3 sentences minimum.}

    - id: cap-002
      name: "{Capability Name}"
      description: |
        {Capability description}

    # Add 3-5 capabilities typically

# Contexts: UI/API/Email/Notification contexts where feature appears
contexts:
  - id: ctx-001
    name: "{Context Name}"  # Example: "Login Screen"
    description: |
      {Describe this context. Where does it appear? What does it present?
      What can users do here? Be specific about UI location, access controls,
      interactions, and data displayed.}
    ui_location: "{Navigation path}"  # Example: "Main navigation → Settings → Security"
    access_control:
      - "{Who can access this context}"  # Example: "All authenticated users"
    key_interactions:  # REQUIRED: Minimum 1 item
      - "{User action 1}"  # Example: "Enter username and password"
      - "{User action 2}"
    data_displayed:  # REQUIRED: Minimum 1 item
      - "{Data element 1}"  # Example: "Login form with email/password fields"
      - "{Data element 2}"

  # Add contexts as needed (typically 2-4)

# Value Propositions: Exactly 4 personas required by schema v2.0
value_propositions:
  - persona: "{Character Name, Role at Organization}"  # Example: "Sarah Martinez, Product Manager at TechFlow Inc."
    metrics:
      pain: "{Specific pain metric}"  # Example: "Spends 3-4 hours per week manually managing user access requests"
      benefit: "{Specific benefit}"  # Example: "Automated approval workflow reduces to 30 minutes per week"
      roi: "{ROI statement}"  # Example: "80% time savings, faster employee onboarding"

    # Each narrative paragraph MUST be 200+ characters (schema requirement)
    current_situation: |
      {200+ character paragraph describing current pain. Be specific: What tasks?
      How long? What friction? What manual processes? What tools used?
      What coordination required? What goes wrong? Use concrete details and metrics.}

    transformation_moment: |
      {200+ character paragraph describing solution experience. How does this feature
      change their workflow? What becomes easier? What becomes possible?
      What confidence/clarity/speed do they gain? Describe the "aha moment".}

    emotional_resolution: |
      {200+ character paragraph describing emotional outcome. How do they feel now?
      What relationships improved? What strategic shift occurred? What anxiety reduced?
      What new capabilities emerged? Focus on the personal and professional impact.}

  - persona: "{Persona 2 - Different role/context}"
    metrics:
      pain: "{Persona 2 pain metric}"
      benefit: "{Persona 2 benefit}"
      roi: "{Persona 2 ROI}"
    current_situation: |
      {200+ characters for Persona 2 current situation}
    transformation_moment: |
      {200+ characters for Persona 2 transformation}
    emotional_resolution: |
      {200+ characters for Persona 2 resolution}

  - persona: "{Persona 3 - Different role/context}"
    metrics:
      pain: "{Persona 3 pain metric}"
      benefit: "{Persona 3 benefit}"
      roi: "{Persona 3 ROI}"
    current_situation: |
      {200+ characters for Persona 3 current situation}
    transformation_moment: |
      {200+ characters for Persona 3 transformation}
    emotional_resolution: |
      {200+ characters for Persona 3 resolution}

  - persona: "{Persona 4 - Different role/context}"
    metrics:
      pain: "{Persona 4 pain metric}"
      benefit: "{Persona 4 benefit}"
      roi: "{Persona 4 ROI}"
    current_situation: |
      {200+ characters for Persona 4 current situation}
    transformation_moment: |
      {200+ characters for Persona 4 transformation}
    emotional_resolution: |
      {200+ characters for Persona 4 resolution}

# Scenarios: Top-level structured scenarios (NOT nested in contexts)
scenarios:
  - id: scn-001
    name: "{Scenario Name}"  # Example: "User Registration with Email Verification"
    actor: "{Specific persona from value_propositions}"  # Use actual persona name
    context: "{Where are they? What are they doing?}"  # Example: "Sarah is setting up account for new team member"
    trigger: "{What prompts this action?}"  # Example: "New employee starts next week, needs system access"
    action: "{What specific steps do they take?}"  # Example: "Sarah enters employee email, assigns role, clicks 'Send Invite'"
    outcome: "{What happens? What changes?}"  # Example: "System sends verification email, creates pending account, notifies Sarah"
    acceptance_criteria:
      - "{Criterion 1}"  # Example: "Email sent within 30 seconds"
      - "{Criterion 2}"  # Example: "Account created with correct role permissions"
      - "{Criterion 3}"  # Example: "Sarah receives confirmation notification"

  - id: scn-002
    name: "{Scenario 2 Name}"
    actor: "{Persona name}"
    context: "{Context description}"
    trigger: "{Trigger event}"
    action: "{Action taken}"
    outcome: "{Outcome achieved}"
    acceptance_criteria:
      - "{Criterion 1}"
      - "{Criterion 2}"

  # Add 4-6 scenarios typically covering main user journeys

# Dependencies: Rich dependency objects with WHY explanations
dependencies:
  # Features this feature REQUIRES (must exist first)
  requires:
    - id: fd-{number}  # Example: fd-001
      name: "{Required Feature Name}"  # Example: "Email Notification System"
      reason: |
        {30+ character explanation of WHY this dependency exists. What capability
        or infrastructure does the required feature provide that this feature needs?
        Be specific about the technical or functional dependency.}

  # Features this feature ENABLES (dependent on this)
  enables:
    - id: fd-{number}  # Example: fd-009
      name: "{Enabled Feature Name}"  # Example: "Single Sign-On Integration"
      reason: |
        {30+ character explanation of how this feature enables the dependent feature.
        What foundation does it provide? What becomes possible?}

# Technical Notes (optional but recommended)
technical_notes: |
  {Any implementation notes, architectural constraints, integration requirements,
  or technical context helpful for the implementation team. NOT required by schema,
  but valuable for handoff to spec-driven development tools.}
